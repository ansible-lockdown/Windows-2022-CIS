---

# Section 1 Account Policies
# 1.1.x Password Policy, 1.2.x Account Lockout Policy
win22cis_section01: true

# Section 2 Local Policies
# 2.2.x User Rights Assignment, 2.3.x Security Options
win22cis_section02: true

# Section 5 System Services
# 5.x Printers
win22cis_section05: true

# Section 9 Windows Defender Firewall with Advanced Security (formerly Windows Firewall with Advanced Security)
# 9.1.x Domain Profile, 9.2.x Private Profile, 9.3.x Public Profile
win22cis_section09: true

# Section 17 Advanced Audit Policy Configuration
# 17.1.x Account Logon, 17.2.x Account Management, 17.3.x Detailed Tracking, 17.4.x DS Access, 17.5.x Logon/Logoff
# 17.6.x Object Access, 17.7.x Policy Change, 17.8.x Privilege Use, 17.9.x System
win22cis_section17: true

# Section 18 Administrative Templates (Computer)
# 18.1.x Control Panel, 18.2.x LAPS, 18.3.x MS Security Guide, 18.4.x MSS (Legacy), 18.5.x Network, 18.6.x Printers
# 18.7.x Start Menu and Taskbar, 18.8.x System, 18.9.x Windows Components
win22cis_section18: true

# Section 19 Administrative Templates (User)
# 19.1.x Control Panel, 19.5.x Start Menu and Taskbar, 19.6.x System, 19.7.x Windows Components
win22cis_section19: true

min_ansible_version: "2.10"

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
complexity_high: true

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
disruption_high: false

# Show "changed" for disruptive items not remediated per disruption-high
# setting to make them stand out.
audit_disruptive: false

# tweak role to run in a non-privileged container
system_is_container: false

# set to false to skip long running tasks
long_running: false

# win_skip_for_test is used in the playbook to skip over WINRM based controls that
# may cause WINRM Basic Connection Type to be disabled.
# Setting win_skip_for_test to 'false' will enable Secure Connection types only.
# win22cis_rule_2_3_1_5
# win22cis_rule_9_3_5
# win22cis_rule_18_9_102_1_1
# win22cis_rule_18_9_102_1_2
# win22cis_rule_18_9_102_2_1
# win22cis_rule_18_9_102_2_2
# win22cis_rule_18_9_102_2_3
# win22cis_rule_18_9_103_1
win_skip_for_test: true

# These variables correspond with the STIG IDs defined in the STIG and allows you to enable/disable specific rules.
# PLEASE NOTE: These work in coordination with the cat1, cat2, cat3 group variables. You must enable an entire group
# in order for the variables below to take effect.

# section01
win22cis_rule_1_1_1: true
win22cis_rule_1_1_2: true
win22cis_rule_1_1_3: true
win22cis_rule_1_1_4: true
win22cis_rule_1_1_5: true
# win22cis_rule_1_1_6 set To false this control cannot be implemented on 2022.
# This setting is only available within the built-in OS security template of
# Windows 10 Release 2004 and Server 2022 (or newer). Control Commented out for now.
win22cis_rule_1_1_6: false
win22cis_rule_1_1_7: true
# We have found the order of these three tasks below varies between cloud based instances
# and VM based instances locally. The task below breaks out to run in a different order
# for cloud based systems and local based systems. Notes are applied in the section01.yml file.
win22cis_rule_1_2_1: true
win22cis_rule_1_2_2: true
win22cis_rule_1_2_3: true
win22cis_rule_1_2_4: true

# section02
win22cis_rule_2_2_1: true
win22cis_rule_2_2_2: true
win22cis_rule_2_2_3: true
win22cis_rule_2_2_4: true
win22cis_rule_2_2_5: true
win22cis_rule_2_2_6: true
win22cis_rule_2_2_7: true
win22cis_rule_2_2_8: true
win22cis_rule_2_2_9: true
win22cis_rule_2_2_10: true
win22cis_rule_2_2_11: true
win22cis_rule_2_2_12: true
win22cis_rule_2_2_13: true
win22cis_rule_2_2_14: true
win22cis_rule_2_2_15: true
win22cis_rule_2_2_16: true
win22cis_rule_2_2_17: true
win22cis_rule_2_2_18: true
win22cis_rule_2_2_19: true
win22cis_rule_2_2_20: true
win22cis_rule_2_2_21: true
win22cis_rule_2_2_22: true
win22cis_rule_2_2_23: true
win22cis_rule_2_2_24: true
win22cis_rule_2_2_25: true
win22cis_rule_2_2_26: true
win22cis_rule_2_2_27: true
win22cis_rule_2_2_28: true
win22cis_rule_2_2_29: true
win22cis_rule_2_2_30: true
win22cis_rule_2_2_31: true
win22cis_rule_2_2_32: true
win22cis_rule_2_2_33: true
win22cis_rule_2_2_34: true
win22cis_rule_2_2_35: true
win22cis_rule_2_2_36: true
win22cis_rule_2_2_37: true
win22cis_rule_2_2_38: true
win22cis_rule_2_2_39: true
win22cis_rule_2_2_40: true
win22cis_rule_2_2_41: true
win22cis_rule_2_2_42: true
win22cis_rule_2_2_43: true
win22cis_rule_2_2_44: true
win22cis_rule_2_2_45: true
win22cis_rule_2_2_46: true
win22cis_rule_2_2_47: true
win22cis_rule_2_2_48: true
win22cis_rule_2_3_1_1: true
win22cis_rule_2_3_1_2: true
win22cis_rule_2_3_1_3: true
win22cis_rule_2_3_1_4: true
# Setting win22cis_rule_2_3_1_5 Control To True Will Break Ansible Connection
# Setting win_skip_for_test: true -- will skip the controls here even if they are set to true.
win22cis_rule_2_3_1_5: true
win22cis_rule_2_3_2_1: true
win22cis_rule_2_3_2_2: true
win22cis_rule_2_3_4_1: true
win22cis_rule_2_3_4_2: true
win22cis_rule_2_3_5_1: true
win22cis_rule_2_3_5_2: true
win22cis_rule_2_3_5_3: true
win22cis_rule_2_3_5_4: true
win22cis_rule_2_3_5_5: true
win22cis_rule_2_3_6_1: true
win22cis_rule_2_3_6_2: true
win22cis_rule_2_3_6_3: true
win22cis_rule_2_3_6_4: true
win22cis_rule_2_3_6_5: true
win22cis_rule_2_3_6_6: true
win22cis_rule_2_3_7_1: true
win22cis_rule_2_3_7_2: true
win22cis_rule_2_3_7_3: true
win22cis_rule_2_3_7_4: true
win22cis_rule_2_3_7_5: true
win22cis_rule_2_3_7_6: true
win22cis_rule_2_3_7_7: true
win22cis_rule_2_3_7_8: true
win22cis_rule_2_3_7_9: true
win22cis_rule_2_3_8_1: true
win22cis_rule_2_3_8_2: true
win22cis_rule_2_3_8_3: true
win22cis_rule_2_3_9_1: true
win22cis_rule_2_3_9_2: true
win22cis_rule_2_3_9_3: true
win22cis_rule_2_3_9_4: true
win22cis_rule_2_3_9_5: true
win22cis_rule_2_3_10_1: true
win22cis_rule_2_3_10_2: true
win22cis_rule_2_3_10_3: true
win22cis_rule_2_3_10_4: true
win22cis_rule_2_3_10_5: true
win22cis_rule_2_3_10_6: true
win22cis_rule_2_3_10_7: true
win22cis_rule_2_3_10_8: true
win22cis_rule_2_3_10_9: true
win22cis_rule_2_3_10_10: true
win22cis_rule_2_3_10_11: true
win22cis_rule_2_3_10_12: true
win22cis_rule_2_3_10_13: true
win22cis_rule_2_3_11_1: true
win22cis_rule_2_3_11_2: true
win22cis_rule_2_3_11_3: true
win22cis_rule_2_3_11_4: true
win22cis_rule_2_3_11_5: true
win22cis_rule_2_3_11_6: true
win22cis_rule_2_3_11_7: true
win22cis_rule_2_3_11_8: true
win22cis_rule_2_3_11_9: true
win22cis_rule_2_3_11_10: true
win22cis_rule_2_3_13_1: true
win22cis_rule_2_3_15_1: true
win22cis_rule_2_3_15_2: true
win22cis_rule_2_3_17_1: true
win22cis_rule_2_3_17_2: true
win22cis_rule_2_3_17_3: true
win22cis_rule_2_3_17_4: true
win22cis_rule_2_3_17_5: true
win22cis_rule_2_3_17_6: true
win22cis_rule_2_3_17_7: true
win22cis_rule_2_3_17_8: true

# section05
win22cis_rule_5_1: true
win22cis_rule_5_2: true

# section09
win22cis_rule_9_1_1: true
win22cis_rule_9_1_2: true
win22cis_rule_9_1_3: true
win22cis_rule_9_1_4: true
win22cis_rule_9_1_5: true
win22cis_rule_9_1_6: true
win22cis_rule_9_1_7: true
win22cis_rule_9_1_8: true
win22cis_rule_9_2_1: true
win22cis_rule_9_2_2: true
win22cis_rule_9_2_3: true
win22cis_rule_9_2_4: true
win22cis_rule_9_2_5: true
win22cis_rule_9_2_6: true
win22cis_rule_9_2_7: true
win22cis_rule_9_2_8: true
win22cis_rule_9_3_1: true
win22cis_rule_9_3_2: true
win22cis_rule_9_3_3: true
win22cis_rule_9_3_4: true
# Setting win22cis_rule_9_3_5 Control To True Will Break Ansible Connection
# Setting win_skip_for_test: true -- will skip the controls here even if they are set to true.
win22cis_rule_9_3_5: true
win22cis_rule_9_3_6: true
win22cis_rule_9_3_7: true
win22cis_rule_9_3_8: true
win22cis_rule_9_3_9: true
win22cis_rule_9_3_10: true

# section17
win22cis_rule_17_1_1: true
win22cis_rule_17_1_2: true
win22cis_rule_17_1_3: true
win22cis_rule_17_2_1: true
win22cis_rule_17_2_2: true
win22cis_rule_17_2_3: true
win22cis_rule_17_2_4: true
win22cis_rule_17_2_5: true
win22cis_rule_17_2_6: true
win22cis_rule_17_3_1: true
win22cis_rule_17_3_2: true
win22cis_rule_17_4_1: true
win22cis_rule_17_4_2: true
win22cis_rule_17_5_1: true
win22cis_rule_17_5_2: true
win22cis_rule_17_5_3: true
win22cis_rule_17_5_4: true
win22cis_rule_17_5_5: true
win22cis_rule_17_5_6: true
win22cis_rule_17_6_1: true
win22cis_rule_17_6_2: true
win22cis_rule_17_6_3: true
win22cis_rule_17_6_4: true
win22cis_rule_17_7_1: true
win22cis_rule_17_7_2: true
win22cis_rule_17_7_3: true
win22cis_rule_17_7_4: true
win22cis_rule_17_7_5: true
win22cis_rule_17_8_1: true
win22cis_rule_17_9_1: true
win22cis_rule_17_9_2: true
win22cis_rule_17_9_3: true
win22cis_rule_17_9_4: true
win22cis_rule_17_9_5: true

# section18
win22cis_rule_18_1_1_1: true
win22cis_rule_18_1_1_2: true
win22cis_rule_18_1_2_2: true
win22cis_rule_18_1_3: true
win22cis_rule_18_3_1: true
win22cis_rule_18_3_2: true
win22cis_rule_18_3_3: true
win22cis_rule_18_3_4: true
win22cis_rule_18_3_5: true
win22cis_rule_18_3_6: true
win22cis_rule_18_4_1: true
win22cis_rule_18_4_2: true
win22cis_rule_18_4_3: true
win22cis_rule_18_4_4: true
win22cis_rule_18_4_5: true
win22cis_rule_18_4_6: true
win22cis_rule_18_4_7: true
win22cis_rule_18_5_1: true
win22cis_rule_18_5_2: true
win22cis_rule_18_5_3: true
win22cis_rule_18_5_4: true
win22cis_rule_18_5_5: true
win22cis_rule_18_5_6: true
win22cis_rule_18_5_7: true
win22cis_rule_18_5_8: true
win22cis_rule_18_5_9: true
win22cis_rule_18_5_10: true
win22cis_rule_18_5_11: true
win22cis_rule_18_5_12: true
win22cis_rule_18_6_4_1: true
win22cis_rule_18_6_4_2: true
win22cis_rule_18_6_4_3: true
win22cis_rule_18_6_5_1: true
win22cis_rule_18_6_8_1: true
win22cis_rule_18_6_9_1: true
win22cis_rule_18_6_9_2: true
win22cis_rule_18_6_10_2: true
win22cis_rule_18_6_11_2: true
win22cis_rule_18_5_11_3: true
win22cis_rule_18_6_11_4: true
win22cis_rule_18_6_14_1: true
win22cis_rule_18_6_19_2_1: true
win22cis_rule_18_6_20_1: true
win22cis_rule_18_6_20_2: true
win22cis_rule_18_6_21_1: true
win22cis_rule_18_6_21_2: true
win22cis_rule_18_7_1: true
win22cis_rule_18_7_10: true
win22cis_rule_18_7_11: true
win22cis_rule_18_8_1_1: true
win22cis_rule_18_7_8: true
win22cis_rule_18_9_3_1: true
win22cis_rule_18_9_4_1: true
win22cis_rule_18_9_4_2: true
win22cis_rule_18_9_5_1: true
win22cis_rule_18_9_5_2: true
win22cis_rule_18_9_5_3: true
win22cis_rule_18_9_5_4: true
win22cis_rule_18_9_5_5: true
win22cis_rule_18_9_5_6: true
win22cis_rule_18_9_5_7: true
win22cis_rule_18_8_7_2: true
win22cis_rule_18_9_13_1: true
win22cis_rule_18_9_19_2: true
win22cis_rule_18_9_19_3: true
win22cis_rule_18_9_19_4: true
win22cis_rule_18_9_19_5: true
win22cis_rule_18_9_20_1_1: true
win22cis_rule_18_9_20_1_2: true
win22cis_rule_18_9_20_1_3: true
win22cis_rule_18_9_20_1_4: true
win22cis_rule_18_9_20_1_5: true
win22cis_rule_18_9_20_1_6: true
win22cis_rule_18_9_20_1_7: true
win22cis_rule_18_9_20_1_8: true
win22cis_rule_18_9_20_1_9: true
win22cis_rule_18_9_20_1_10: true
win22cis_rule_18_9_20_1_11: true
win22cis_rule_18_9_20_1_12: true
win22cis_rule_18_9_20_1_13: true
win22cis_rule_18_9_23_1: true
win22cis_rule_18_9_24_1: true
win22cis_rule_18_9_25_1: true
win22cis_rule_18_9_25_2: true
win22cis_rule_18_9_26_1: true
win22cis_rule_18_9_27_1: true
win22cis_rule_18_9_27_2: true
win22cis_rule_18_9_27_3: true
win22cis_rule_18_9_27_4: true
win22cis_rule_18_9_27_5: true
win22cis_rule_18_9_27_6: true
win22cis_rule_18_9_27_7: true
win22cis_rule_18_9_30_1: true
win22cis_rule_18_9_30_2: true
win22cis_rule_18_9_32_6_1: true
win22cis_rule_18_3_32_6_2: true
win22cis_rule_18_9_32_6_3: true
win22cis_rule_18_9_32_6_4: true
win22cis_rule_18_9_34_1: true
win22cis_rule_18_9_34_2: true
win22cis_rule_18_9_35_1: true
win22cis_rule_18_9_35_2: true
win22cis_rule_18_9_38_1: true
win22cis_rule_18_9_46_5_1: true
win22cis_rule_18_9_46_11_1: true
win22cis_rule_18_9_48_1: true
win22cis_rule_18_9_50_1_1: true
win22cis_rule_18_9_50_1_2: true
win22cis_rule_18_10_3_1: true
win22cis_rule_18_10_5_1: true
win22cis_rule_18_10_7_1: true
win22cis_rule_18_10_7_2: true
win22cis_rule_18_10_7_3: true
win22cis_rule_18_10_8_1_1: true
win22cis_rule_18_10_10_1: true
win22cis_rule_18_10_12_1: true
win22cis_rule_18_10_12_2: true
win22cis_rule_18_9_14_3: true
win22cis_rule_18_10_13_1: true
win22cis_rule_18_10_14_1: true
win22cis_rule_18_10_14_2: true
win22cis_rule_18_10_15_1: true
win22cis_rule_18_10_15_2: true
win22cis_rule_18_10_15_3: true
win22cis_rule_18_10_15_4: true
win22cis_rule_18_10_15_5: true
win22cis_rule_18_10_15_6: true
win22cis_rule_18_10_15_7: true
win22cis_rule_18_10_15_8: true
win22cis_rule_18_10_17_1: true
win22cis_rule_18_10_17_2: true
win22cis_rule_18_10_17_3: true
win22cis_rule_18_10_17_4: true
win22cis_rule_18_10_26_1_1: true
win22cis_rule_18_10_26_1_2: true
win22cis_rule_18_10_26_2_1: true
win22cis_rule_18_10_26_2_2: true
win22cis_rule_18_10_26_3_2: true
win22cis_rule_18_10_26_4_1: true
win22cis_rule_18_10_26_4_2: true
win22cis_rule_18_10_29_2: true
win22cis_rule_18_10_29_3: true
win22cis_rule_18_10_29_4: true
win22cis_rule_18_10_37_1: true
win22cis_rule_18_10_41_1: true
win22cis_rule_18_10_42_1: true
win22cis_rule_18_10_43_5_1: true
win22cis_rule_18_10_43_5_2: true
win22cis_rule_18_10_43_6_1_1: true
win22cis_rule_18_10_43_6_1_2: true
win22cis_rule_18_10_43_6_3_1: true
win22cis_rule_18_10_43_7_1: true
win22cis_rule_18_10_43_10_1: true
win22cis_rule_18_10_43_10_2: true
win22cis_rule_18_10_43_10_3: true
win22cis_rule_18_10_43_10_4: true
win22cis_rule_18_10_43_12_1: true
win22cis_rule_18_10_43_13_1: true
win22cis_rule_18_10_43_13_2: true
win22cis_rule_18_10_43_16: true
win22cis_rule_18_10_43_17: true
win22cis_rule_18_10_51_1: true
win22cis_rule_18_10_56_1: true
win22cis_rule_18_10_57_2_2: true
win22cis_rule_18_10_57_3_2_1: true
win22cis_rule_18_10_57_3_3_1: true
win22cis_rule_18_10_57_3_3_2: true
win22cis_rule_18_10_57_3_3_3: true
win22cis_rule_18_10_57_3_3_4: true
win22cis_rule_18_10_57_3_3_5: true
win22cis_rule_18_10_57_3_3_6: true
win22cis_rule_18_10_57_3_9_1: true
win22cis_rule_18_10_57_3_9_2: true
win22cis_rule_18_10_57_3_9_3: true
win22cis_rule_18_10_57_3_9_4: true
win22cis_rule_18_10_57_3_9_5: true
win22cis_rule_18_10_57_3_10_1: true
win22cis_rule_18_10_57_3_10_2: true
win22cis_rule_18_10_57_3_11_1: true
win22cis_rule_18_10_57_3_11_2: true
win22cis_rule_18_10_58_1: true
win22cis_rule_18_10_59_2: true
win22cis_rule_18_10_59_3: true
win22cis_rule_18_10_59_4: true
win22cis_rule_18_10_63_1: true
win22cis_rule_18_10_76_2_1: true
win22cis_rule_18_10_80_1: true
win22cis_rule_18_10_80_2: true
win22cis_rule_18_10_81_1: true
win22cis_rule_18_10_81_2: true
win22cis_rule_18_10_81_3: true
win22cis_rule_18_10_82_1: true
win22cis_rule_18_10_82_2: true
win22cis_rule_18_10_87_1: true
win22cis_rule_18_10_87_2: true
# WINRM CONTROLS #
# Setting The Following Controls To True Will Break Ansible Connection
# Setting win_skip_for_test: true -- will skip the controls here even if they are set to true.
# win22cis_rule_18_10_89_1_1
# win22cis_rule_18_10_89_1_2
# win22cis_rule_18_10_89_2_1
# win22cis_rule_18_10_89_2_2
# win22cis_rule_18_10_89_2_3
win22cis_rule_18_10_89_1_1: true
win22cis_rule_18_10_89_1_2: true
win22cis_rule_18_10_89_2_1: true
win22cis_rule_18_10_89_2_2: true
win22cis_rule_18_10_89_2_3: true
# This control will have to be set to Enabled (1) to allow for continued remote management via Ansible following
# machine restart. The CIS standard calls for 0 but doing so will break all remote connections to the system.
win22cis_rule_18_10_89_1_3: true
win22cis_rule_18_10_89_2_4: true
win22cis_rule_18_10_90_1: true
# WINRM CONTROLS END #
win22cis_rule_18_10_92_2_1: true
win22cis_rule_18_10_93_1_1: true
win22cis_rule_18_10_93_2_1: true
win22cis_rule_18_10_93_2_2: true
win22cis_rule_18_10_93_4_1: true
win22cis_rule_18_10_93_4_2: true
win22cis_rule_18_10_93_4_3: true


# section19
win22cis_rule_19_1_3_1: true
win22cis_rule_19_1_3_2: true
win22cis_rule_19_1_3_3: true
win22cis_rule_19_5_1_1: true
win22cis_rule_19_6_6_1_1: true
win22cis_rule_19_7_4_1: true
win22cis_rule_19_7_4_2: true
win22cis_rule_19_7_7_1: true
win22cis_rule_19_7_7_2: true
win22cis_rule_19_7_7_3: true
win22cis_rule_19_7_7_4: true
win22cis_rule_19_7_7_5: true
win22cis_rule_19_7_25_1: true
win22cis_rule_19_7_40_1: true
win22cis_rule_19_7_42_2_1: true

# Section 1 Variables

# 1.1.1
# win22cis_max_passwords_saved is the variable used to dictate the number of unique passwords
# that have to be associated with a user account before you can reuse an old password.
# The recommended state for this setting is 24 Or More passwords.
# NOTE: As Of the publication if this benchmark, Microsoft has a maximum limit of 24 saved passwords.
# This may change at a later date but we have left it setup as a variable for that reason.
win22cis_max_passwords_saved: 24

# 1.1.2
# win22cis_maximum_password_age is the policy setting defines how long a user can use their
# password before it expires.
# The recommended state for this setting is 365 or fewer days, but not 0 (zero).
win22cis_maximum_password_age: 365

# 1.1.3
# win22cis_minimum_password_age is the policy setting determines the number of days that you
# must use a password before you can change it. The range of values for this policy setting is
# between 1 and 999 days. (You may also set the value to 0 to allow immediate password changes.)
# The default value for this setting is 0 days.
# The recommended state for this setting is: 1 or more day(s)
win22cis_minimum_password_age: 1

# 1.1.4
# win22cis_minimum_password_length is the policy setting determines the least number of characters
# that make up a password for a user account.
# The recommended state for this setting is: 14 or more character(s).
win22cis_minimum_password_length: 14

# 1.2.1
# win22cis_account_lockout_duration is the  policy setting determines the length of time that
# must pass before a locked account is unlocked and a user can try to log on again.
# NOTE: If the value for this policy setting is configured to 0, locked out accounts will remain locked out
# until an administrator manually unlocks them.
# The recommended state for this setting is: 15 or more minute(s).
win22cis_account_lockout_duration: 15

# 1.2.2
# win22cis_lockout_bad_count is the policy setting determines the number of failed logon
# attempts before the account is locked.
# The recommended state for this setting is: 5 or fewer invalid logon attempt(s), but not 0.
win22cis_bad_login_lockout_count: 5

# 1.2.3
# win22cis_allow_admin_account_lockout is the policy setting determines whether the built-in
# Administrator account is subject to the following Account Lockout Policy settings.
# win22cis_allow_admin_account_lockout: 1

# 1.2.4
# win22cis_account_lockout_counter_reset is the policy setting determines the length of time before the
# Account lockout threshold resets to zero. The default value for this policy setting is Not Defined.
# NOTE: If the Account lockout threshold is defined (win22cis_account_lockout_duration), this reset
# time must be less than or equal to the value for the Account lockout duration setting.
# The recommended state for this setting is: 15 or more minute(s).
win22cis_account_lockout_counter_reset: 15

# Section 2 Variables

# 2.2.18
# is_hyperv_installed is Hyper-V installed
win22cis_hyperv_installed: false

# 2.2.33
# Window Manager\Window Manager Group only exists on non Core installations
# windows_installation_type should be 'Server Core' for Core installations
# This is a variable to determine if Windows Manager should be included in this step
win22cis_increase_scheduling_priority_users: '{{ ["Administrators"] if (windows_installation_type=="Server Core") else (["Administrators","Window Manager\Window Manager Group"]) }}'

# 2.2.37
# win22cis_exchange_server_running is the policy setting determines which users can change the auditing options for
# files and directories and clear the Security log. Setting to true will set both groups to be added.
# False will only add Administrators.
# True will add administrators and (when Exchange is running in the environment) Exchange Servers.
# The recommended state for this setting is: Administrators and when Exchange is running in the environment) Exchange Servers.
win22cis_exchange_server_running: false

# 2.3.1.4
# win22cis_admin_username is the name the administrator account will be renamed to
win22cis_admin_username: adminchangethis

# 2.3.1.5
# win22cis_guest_username is the name the guest account will be renamed to
win22cis_guest_username: guestchangethis

# 2.3.6.5
# win22cis_domain_member_maximum_password_age is the policy setting determines the maximum allowable age for a
# computer account password. By default, domain members automatically change their domain passwords every 30 days.
# The recommended state for this setting is: 30 or fewer days, but not 0.
win22cis_domain_member_maximum_password_age: 30

# 2.3.6.5
# win22cis_machine_acct_pw_age is the max machine account pw age in days
# This value should be set to 30 or fewer, but not zero, to be CIS compliant
win22cis_machine_acct_pw_age: 30

# 2.3.7.3
# win22cis_inactivity_timeout is the timeout in seconds for how long to wait for activity
# This value should be 900 or vewer, but not zero, to be CIS compliant
win22cis_inactivity_timeout: 900

# 2.3.7.7
# win22cis_passwd_expiry_warn is the number of days before an expring password users will receive warnings about the expring password
# This needs to be between 4 adn 14 days to be CIS compliant
win22cis_passwd_expiry_warn: 14

# 2.3.7.9
# win22cis_smartc_remove_option is the reg key option on the action when a SmartCard is removed
# This needs to be set to 1 (Lock Workstation) or 2 (Force Logoff) to be CIS compliant
win22cis_smartc_remove_option: "1"

# 2.3.9.1
# win22cis_auto_disconnect is the duration in minutes of idle time before suspending the session
# This needs to be set to 15 or fewer to be CIS compliant
win22cis_auto_disconnect: 15

# 2.3.7.3
# win22cis_inactivity_timeout_seconds is the variable used to set when Windows notices inactivity of a logon session,
# and if the amount of inactive time exceeds the inactivity limit, then the screen saver will run, locking the session.
# The recommended state for this setting is: 900 or fewer second(s), but not 0.
win22cis_inactivity_timeout_seconds: 900

# 2.3.7.4
# win22cis_legal_notice is the setting that specifies a text message that displays to users when they log on.
# Configure this setting in a manner that is consistent with the security and operational requirements of your organization.
win22cis_legal_notice: |
    You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you consent to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

# 2.3.7.5
# win22cis_legal_notice_caption is the policy setting specifies the text displayed in the title bar of the window that users see
# when they log on to the system. Configure this setting in a manner that is consistent with the security and operational
# requirements of your organization.
win22cis_legal_notice_caption: "DoD Notice and Consent Banner"

# 2.3.7.6
# win22cis_cached_logons_count is the number that is assigned to this policy setting indicates the number of users whose
# logon information the computer will cache locally. If this value is set to 0, the logon cache feature is disabled.
# The recommended state for this setting is: 4 or fewer logon(s).
win22cis_cached_logons_count: 1

# 2.3.7.7
# win22cis_password_expiry_warning_days is the policy setting determines how far in advance users are warned that their password will expire.
# The recommended state for this setting is: between 5 and 14 days.
win22cis_password_expiry_warning_days: 14

# 2.3.9.1
# win22cis_smb_auto_disconnect_time is the policy setting allows you to specify the amount of continuous idle time that must pass in an
# SMB session before the session is suspended because of inactivity.
# The recommended state for this setting is: 15 or fewer minute(s).
win22cis_smb_auto_disconnect_time: 15

# Section 9 Variables

# 9.1.5
# win22cis_domain_firewall_log_path is the path to the domain firewall log files. The control suggests %SystemRoot%\System32\logfiles\firewall\domainfw.log
# This is a variable to give some leway on where to store these log files
win22cis_domain_firewall_log_path: '%SystemRoot%\System32\logfiles\firewall\domainfw.log'

# 9.1.6
# win22cis_domain_firewall_log_size is the size of the log file generated
# To conform to CIS standards the value should be 16,384 or greater. Value is in KB
win22cis_domain_firewall_log_size: 16384

# 9.2.5
# private_firewall_log_path is the path to the private firewall log files. The control suggests %SystemRoot%\System32\logfiles\firewall\privatefw.log
# This is a variable to give some leway on where to store these log files
win22cis_private_firewall_log_path: '%SystemRoot%\System32\logfiles\firewall\privatefw.log'

# 9.2.6
# private_firewall_log_size is the size of the log file
# To conform to CIS stadnards the value should be 16,384 or greater. Value is in KB
win22cis_private_firewall_log_size: 16384

# 9.3.7
# win22cis_public_firewall_log_path is the path to the public firewall log file. The control suggests %SystemRoot%\System32\logfiles\firewall\publicfw.log
# This is a variable to give some leway on where to store these log files
win22cis_public_firewall_log_path: '%SystemRoot%\System32\logfiles\firewall\publicfw.log'

# 9.3.8
# public_firewall_log_size is the size of the log file
# To conform to CIS stadnards the value should be 16,384 or greater. Value is in KB
win22cis_public_firewall_log_size: 16384

# Section 18 Variables

# Control 18.2.5
# laps_passwordlength is the LAPS tool password length.
# To conform to CIS standards please use a min value of 15 and max value of 127
win22cis_laps_passwordlength: 15

# Control 18.2.6
# laps_passwordagedays is the LAPS tool password age in days
# To conform to CIS standards please use a max value of 30
win22cis_laps_passwordagedays: 30

# Control 18.2.5
# win22cis_laps_password_length is the LAPS tool password length.
# The recommended state for this setting is: Enabled: 15 or more.
win22cis_laps_password_length: 15

# Control 18.2.6
# win22cis_laps_password_age_days is the LAPS tool password age in days.
# The recommended state for this setting is: Enabled: 30 or fewer.
win22cis_laps_password_age_days: 30

# 18.3.6
# win22cis_netbt_nodetype is the node type value in HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters:NodeType
# Options are B-node value of 1, P-node value of 2, M-node value of 4, H-node value of 8. P-node is the recommended setting from CIS
win22cis_netbt_nodetype: 2

# 18.4.9
# win22cis_screen_saver_grace_period is the grace period between when the screen saver is launched and when the console is actually
# locked automatically when screen saver locking is enabled.
# The recommended state for this setting is: Enabled: 5 or fewer seconds.
win22cis_screen_saver_grace_period: 5

# 18.4.9
# win22cis_screen_saver_grace is the time in seconds before the screen saver grace period expires
# To conform to CIS standards the value should be 5 or fewer, with zero as recommended
win22cis_screen_saver_grace: 0

# 18.4.12
# win22cis_log_threshold_audit_event is the setting that can generate a security audit in the Security event log when the
# log reaches a user-defined threshold.
# The recommended state for this setting is: Enabled: 90% or less.
win22cis_log_threshold_audit_event: 90

# 18.4.12
# win22cis_mss_security_warn_thresh is the threshold at which the event log will start warning
# To conform to CIS standards the value should be 90 or less
win22cis_mss_security_warn_thresh: 90

# 18.5.4.1
# win22cis_dns_over_https is the registry value for the DoHPolicy regkey entry
# To conform to CIS standards this value needs to be 0 or 1
win22cis_dns_over_https: 1

# 18.8.40.1
# win22cis_sam_ng_key_roc is the value for the ROCA-vulnerable WHfB keys during authentication registry key value
# To conform to CIS standards this value needs to be 1 or 2
win22cis_sam_ng_key_roc: 1

# 18.9.15.1
# wincis_require_pin_pairing is the value for the require pin for pairing registry key
# To conform to CIS standards this value should be 1 or 2
win22cis_require_pin_pairing: 1

# 18.10.17.1
# win22cis_diag_data is the value for the Allow Diagnostic Data registry key
# To confrom to CIS standards this value should be a 0 or 1
win22cis_diag_data: 0

# 18.10.26.1.2
# win22cis_elm_applog_max_size is the max size of the Event Log Manager Application logs can become, in KB
# To conform to CIS stadnards this value should be 32768 or greater
win22cis_elm_applog_max_size: 65538

# 18.10.26.2.2
# win22cis_elm_seclog_max_size is the max size of the Event Log Manager Security logs can become, in KB
# To confrom to CIS standards this value should be 196608 or greater
win22cis_elm_seclog_max_size: 196608

# 18.10.26.1.2
# win22cis_application_max_log_file_size is the setting that specifies the maximum size of the log file in kilobytes. The maximum log file size can be
# configured between 1 megabyte (1,024 kilobytes) and 4 terabytes (4,194,240 kilobytes) in kilobyte increments.
# The recommended state for this setting is: Enabled: 32,768 or greater
win22cis_application_max_log_file_size: 32768

# 18.10.26.2.2
# win22cis_security_max_log_file_size is the setting that specifies the maximum size of the log file in kilobytes. The maximum log file size can
# be configured between 1 megabyte (1,024 kilobytes) and 4 terabytes (4,194,240 kilobytes) in kilobyte increments.
# The recommended state for this setting is: Enabled: 196,608 or greater.
win22cis_security_max_log_file_size: 196608

# 18.10.26.3.2
# win22cis_setup_max_log_file_size is the setting specifies the maximum size of the log file in kilobytes. The maximum log file size can be
# configured between 1 megabyte (1,024 kilobytes) and 4 terabytes (4,194,240 kilobytes) in kilobyte increments.#
# The recommended state for this setting is: Enabled: 32,768 or greater.
win22cis_setup_max_log_file_size: 32768

# 18.10.26.4.2
# win22cis_system_max_log_file_size is the setting that specifies the maximum size of the log file in kilobytes. The maximum log file size
# can be configured between 1 megabyte (1,024 kilobytes) and 4 terabytes (4,194,240 kilobytes) in kilobyte increments.
# The recommended state for this setting is: Enabled: 32,768 or greater.
win22cis_system_max_log_file_size: 32768

# 18.9.27.3.2
# win22cis_elm_setup_max_size is the max size of the Even Log Manager non- standard logs can become, in KB
# To conform to CIS standards this value should be 32768 or higher
win22cis_elm_setup_max_size: 32768

# 18.9.27.4.2
# win22cis_elm_syslog_max_size is the max size of the Event Long Manager System logs can become, in KB
# To conform to CIS standards this value should be 32768 or higher
win22cis_elm_syslog_max_size: 32768

# 18.9.65.3.10.1
# win22cis_idle_rdp_session_disconnect_time is the setting allows you to specify the maximum amount of time that an active Remote Desktop
# Services session can be idle (without user input) before it is automatically disconnected.
# The recommended state for this setting is: Enabled: 15 minutes or less, but not Never (0).
# 1 min = 60000, 5 min = 300000, 10 min = 600000, 15 min = 900000
win22cis_idle_rdp_session_disconnect_time: 900000

# 18.9.65.3.10.1
# win22cis_terminal_max_idle_time is the time limit for active but idle remote desktop services connections in seconds
# This value needs to be 15 minutes (900000) or less, but not zero (0) to conform to CIS standards
win22cis_terminal_max_idle_time: 900000

# 18.9.89.2
# win22cis_allow_ink_workspace is the registry key value for the allowing windows ink workspace
# To conform to CIS stadnards this value should be a 0 or 1
win22cis_allow_ink_workspace: 1

# Section 19 Variables

# 19.1.3.3
# win22cis_screen_saver_timeout is the setting that specifies how much user idle time must elapse before the screen saver is launched.
# The recommended state for this setting is: Enabled: 900 seconds or fewer, but not 0.
win22cis_screen_saver_timeout: 900

# 19.9.108.4.2
# win22cis_defer_feature_update_period is the duration in days to delay feature updates in automatic updates
# To conform to CIS stadnards this value should be 180 or more (365 is max allowed by Windows)
win22cis_defer_feature_update_period: 180
