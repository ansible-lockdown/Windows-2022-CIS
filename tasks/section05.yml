---

- name: |
    "5.1 | PATCH | Ensure Print Spooler (Spooler) is set to Disabled &
     5.2 | PATCH | Ensure Print Spooler (Spooler) is set to Disabled"
  block:
      - name: "5.1 & 5.2 | PATCH | Ensure Print Spooler (Spooler) is set to Disabled in Regedit"
        ansible.windows.win_regedit:
            path: HKLM:\SYSTEM\CurrentControlSet\Services\Spooler
            name: Start
            data: 4
            type: dword
      - name: "5.1 & 5.2 | PATCH | Ensure Print Spooler (Spooler) is set to Disabled in Service"
        ansible.windows.win_service:
            name: spooler
            start_mode: disabled
            state: stopped
  notify: reboot_windows
  when:
      - win22cis_rule_5_1 or
        win22cis_rule_5_2
  tags:
      - level1-domaincontroller
      - level2-domainmember
      - rule_5.1
      - rule_5.2
      - patch
      - printer
